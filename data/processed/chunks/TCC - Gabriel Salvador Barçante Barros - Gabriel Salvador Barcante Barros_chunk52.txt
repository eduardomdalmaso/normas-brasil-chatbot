Single, h As Single, D As Single, G As Single, CA As Single, numaneis As Integer, S As Integer Dim t1 As Single, t2a As Single, tu As Single, tL As Single, tx As Single Dim H1 As Single, r As Single, L As Single, relacao As Single, tol As Single, erro As Single Dim K As Single, C As Single, x1 As Single, x2 As Single, x3 As Single, x As Single Dim Tabela As Range shtOutputCostado.Visible = True shtOutputCostado.Activate G = shtDados.Cells(4, 2) D = shtDados.Cells(5, 2) r = (D / 2) * 10 ^ 3 Hmax = shtDados.Cells(6, 2) numaneis = shtDados.Cells(7, 2) linhain = 11 linhapv = 15 tol = 0.01 uL = shtOutputCostado.Cells(Rows.Count, 2).End(xlUp).Row + 2 shtOutputCostado.Range("B" & linhapv + 1 & ":I" & uL).Clear 'Para condição de projeto e teste hidrostático For kk = 1 To 2 h = Hmax For ii = 1 To numaneis 131 uL = shtBanco.Cells(Rows.Count, 1).End(xlUp).Row For jj = 2 To uL If shtBanco.Cells(jj, 1) = shtInputCostado.Cells(ii + linhain, 4) Then S = shtBanco.Cells(jj, kk + 4) Exit For End If Next jj If kk = 1 Then CA = shtInputCostado.Cells(ii + linhain, 5) Else CA = 0 End If 'Cálculo da espessura do primeiro anel If ii = 1 Then tx = (1.06 - ((0.0696 * D) / h) * Sqr((h * G) / S)) * ((4.9 * h * D * G) / S) + CA t1 = tx - CA L = Sqr((500 * D * t1)) If (L / Hmax) > (1000 / 6) Then MsgBox "O método do ponto variável de projeto não pode ser usado, já que a proporção de 5.6.4.1 da API 650 (2016) não é satisfeita. " End If End If 'Método dos anéis superiores 'Cálculo das espessuras dos anéis superiores, além do t2a If ii <> 1 Then tu = (4.9 * D * (h - 0.3) * G) / S Do K = tL / tu C = (Sqr(K) * (K - 1)) / (1 + K ^ (1.5)) x1 = 0.61 * (Sqr(r * tu)) + 320 * C * h x2 = 1000 * C * h x3 = 1.22 * Sqr(r * tu) x = WorksheetFunction.Min(x1, x2, x3) 132 tx = (4.9 * D * (h - (x / 1000)) * G) / S erro = Abs(tu - tx) tu = tx Loop While erro > tol tx = tx + CA End If 'Cálculo da espessura do segundo anel If ii = 2 Then H1 = shtInputCostado.Cells(linhain + 1, 3) * 10 ^ 3 relacao = H1 / (Sqr(r * t1)) t2a = tx - CA Select Case relacao Case Is <= 1.375 tx = t1 + CA Case Is >= 2.625 tx = t2a + CA Case Else tx = t2a + (t1 - t2a) * (2.1 - (relacao / 1.25)) + CA End Select End If shtOutputCostado.Cells(linhapv + ii, 5 + kk) = tx shtOutputCostado.Cells(linhapv + ii, 5 + kk).NumberFormat = "0.00" tL