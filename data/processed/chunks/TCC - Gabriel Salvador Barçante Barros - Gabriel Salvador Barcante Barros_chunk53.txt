= tx - CA h = Hmax - ii * shtInputCostado.Cells(linhain + ii, 3) Next ii G = 1 Next kk uL = shtInputCostado.Cells(Rows.Count, 2).End(xlUp).Row shtInputCostado.Range("B" & linhain + 1 & ":E" & uL).Copy shtOutputCostado.Range("B" & linhapv + 1).PasteSpecial xlValues Application.CutCopyMode = False 133 'Determinação da espessura requerida uL = shtOutputCostado.Cells(Rows.Count, 2).End(xlUp).Row For ii = linhapv + 1 To uL If shtOutputCostado.Cells(ii, 6) > shtOutputCostado.Cells(ii, 7) And shtOutputCostado.Cells(ii, 6) > tmin Then shtOutputCostado.Cells(ii, 8) = shtOutputCostado.Cells(ii, 6) ElseIf shtOutputCostado.Cells(ii, 7) > shtOutputCostado.Cells(ii, 6) And shtOutputCostado.Cells(ii, 7) > tmin Then shtOutputCostado.Cells(ii, 8) = shtOutputCostado.Cells(ii, 7) ElseIf shtOutputCostado.Cells(ii, 6) < tmin And shtOutputCostado.Cells(ii, 7) < tmin Then shtOutputCostado.Cells(ii, 8) = tmin End If shtOutputCostado.Cells(ii, 8).NumberFormat = "0.00" Next ii 'Determinação da espessura comercial uL = shtOutputCostado.Cells(Rows.Count, 2).End(xlUp).Row For ii = linhapv + 1 To uL For jj = 3 To 46 If shtOutputCostado.Cells(ii, 8) > shtBanco.Cells(jj, "R") And shtOutputCostado.Cells(ii, 8) <= shtBanco.Cells(jj + 1, "R") Then shtOutputCostado.Cells(ii, 9) = shtBanco.Cells(jj + 1, "R") End If Next jj Next ii Set Tabela = shtOutputCostado.Range("B" & linhapv + 1 & ":I" & uL) Call FormatarTabela(Tabela) shtOutputCostado.Cells(11, 5) = (3.14159265358979 * Hmax * D ^ 2) / 4 shtOutputCostado.Cells(1, 1).Select shtDados.Range("E1") = 1 End Sub 134 7.1.2 Código para o projeto do teto Option Explicit Sub Projeto_Teto() Dim DL As Single, Lr As Integer, Pe As Single, Q As Single, Q1 As Single, Gmat As Integer, Fyr As Long, aux As Single, ang As Single, pi As Single Dim b As Single, N As Integer, L As Single, perfil As String, Wreq As Single, Wadot As Single, ppestr As Single, area As Single Dim tn As Single, CA As Single, numcircvigas As Integer, D As Single, Hmax As Single, qv As Single, M As Single, I As Single Dim ii As Integer, jj As Integer, kk As Integer, uL As Integer, uL2 As Integer, linhatetosup As Integer, deubom As Boolean Dim S As Single, Sc As Single, E As Single, cont As Integer, quociente As Single, declteto As Integer, declfundo As Integer Dim lambda As Single, r As Single, FS As Single, ttub As Single, Rtub As Single, y As Single, tensao As Single Dim vetVT() As Integer, vetN() As Integer, vetR() As Single, vetP() As Single, vetPVT() As Single, Tabela As Range Application.ScreenUpdating = False linhatetosup = 15 Hmax = shtDados.Cells(6, 2) D = shtDados.Cells(5, 2) numcircvigas = shtDados.Cells(20, 2) pi = 3.14159265358979 Gmat = 7850 'Densidade do material em kgf/m³ DL = tn * (10 ^ (-3)) * Gmat Lr = 100 Pe = 25 135 Q = DL + Lr + 0.4 * Pe Q1 = DL + 0.4 * Lr + Pe Q = WorksheetFunction.Max(Q, Q1) Select Case shtDados.Range("B17") Case Is = "ASTM A1011M Gr. 33" Fyr = 33400 Case Is = "ASTM A283M Gr. C" Fyr = 30000 Case Is = "ASTM A36M" Fyr = 36000 End Select If shtDados.Cells(15, 2) = "" Then declteto = InputBox("Entrar com o valor da declividade do teto?") End If If shtDados.Cells(9, 2) =