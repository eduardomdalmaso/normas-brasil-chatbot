tensao As Single, tensao0 As Single, tensaomax As Single, G As Single, Hmax As Single Dim S As Integer, ii As Integer, jj As Integer, uL As Integer, Fyb As Integer Dim mat1anel As String, grupomat As String Dim costado As Byte, aux As Boolean, Tabela As Range shtFundo.Range("B14:E15").Clear shtFundo.Visible = True shtFundo.Activate 'Verificação pela API 650 (2016) quanto a necessidade de chapas anulares 'Determinar Tensão de Projeto e Tensão de Teste Hisdrostático costado = shtDados.Range("E1") mat1anel = shtInputCostado.Range("D12") CA = shtInputCostado.Range("E12") uL = shtBanco.Cells(Rows.Count, 1).End(xlUp).Row For jj = 1 To 2 tensao0 = tensao If jj = 2 Then CA = 0 End If If costado = 0 Then If jj = 1 Then t1req = shtOutputCostadoA.Range("G17") t1com = shtOutputCostadoA.Range("H17") If shtOutputCostadoA.Range("H17") = "" Then 145 MsgBox "Os valores das espessuras comerciais devem ser especificados na coluna correspondente." Exit Sub End If End If S = 145 tensao = ((t1req - CA) / (t1com - CA)) * S Else If jj = 1 Then t1req = shtOutputCostado.Range("H16") t1com = shtOutputCostado.Range("I16") If shtOutputCostado.Range("I16") = "" Then MsgBox "Os valores das espessuras comerciais devem ser especificados na coluna correspondente." Exit Sub End If End If For ii = 2 To uL If shtBanco.Cells(ii, 1) = mat1anel Then S = shtBanco.Cells(ii, 4 + jj) grupomat = shtBanco.Cells(ii, "G") Exit For End If Next ii t1dt = shtOutputCostado.Cells(16, 5 + jj) tensao = ((t1dt - CA) / (t1com - CA)) * S End If Next jj tensaomax = WorksheetFunction.Max(tensao, tensao0) CA = shtDados.Range("B11") If shtDados.Range("B10") = "Chapas Anulares" Then mat1anel = shtInputCostado.Range("D12") 146 'CA estipulado para as chapas do fundo Hmax = shtDados.Range("B6") G = shtDados.Range("B4") If G * Hmax <= 23 Then G = WorksheetFunction.Min(G, 1) 'Determinar espessura das chapas anulares pela tabela da API 650 no Banco de Dados For ii = 3 To 7 If t1com <= shtBanco.Cells(ii, "H") Then For jj = 9 To 12 If tensaomax <= shtBanco.Cells(2, jj) Then tb = shtBanco.Cells(ii, jj) + CA aux = True Exit For End If Next jj End If If aux = True Then Exit For Next ii uL = shtBanco.Cells(Rows.Count, 2).End(xlUp).Row For ii = 1 To uL If mat1anel = shtBanco.Cells(ii, 1) And shtBanco.Cells(ii, 2) = "" Then Fyb = shtBanco.Cells(ii, 3) ElseIf mat1anel = shtBanco.Cells(ii, 1) And shtBanco.Cells(ii, 2) <> "" Then If shtBanco.Cells(ii, 2) <= t1com Then Fyb = shtBanco.Cells(ii, 3) End If ElseIf uL = ii And shtBanco.Cells(ii + 1, 1) <> "" Then MsgBox "Rever material utilizado para o costado, já que ele não se adequa as características da " _ & "Tabela 5.2 da API 650 (2016) e com a recomendação que o material do 1º anel do costado seja" _ & " o mesmo que o material das chapas anulares, segundo a N-270 (2014)." Exit Sub 147 End If Next ii 'Cálculo da larura mínima das chapas pela API 650 Wb = 2 * tb * Sqr(Fyb / (2 * 0.00981 * G * Hmax)) Wb = WorksheetFunction.Max(Wb, 600) Wb = Wb +