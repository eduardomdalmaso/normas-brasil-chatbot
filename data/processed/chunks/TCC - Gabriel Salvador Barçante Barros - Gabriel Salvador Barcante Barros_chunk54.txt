"" Then declfundo = InputBox("Entrar com o valor da declividade do fundo?") End If If shtDados.Range("B14") = "Teto Fixo Cônico Suportado" Then shtTetoSup.Visible = True shtTetoSup.Activate uL = shtTetoSup.Cells(Rows.Count, 2).End(xlUp).Row + 1 shtTetoSup.Range("B" & linhatetosup + 1 & ":G" & uL).Clear If shtDados.Range("B16") = 0 Then tn = 4.75 Else tn = 5 + shtDados.Range("B16") End If 136 shtTetoSup.Range("E13") = tn 'Propriedades do material dos perfis estruturais If shtDados.Range("B19") = "ASTM A36M" Then S = 1540 Sc = 910 E = 2100000 Else S = shtDados.Range("B23") Sc = shtDados.Range("B24") E = shtDados.Range("B25") End If b = (tn - CA) * Sqr((1.5 * Fyr) / (Q * 0.00142233)) b = WorksheetFunction.Min(b, 2100) b = b * 10 ^ (-3) 'Armazena o posicionamento das colunas ReDim vetR(numcircvigas + 1) For ii = 1 To numcircvigas + 1 vetR(ii) = shtInputCostado.Cells(11 + ii, "H") Next ii 'Armazena o número de vigas transversais (não usar vetVT(numcircvigas)) ReDim vetVT(numcircvigas) 'Armazena o número de vigas radias ReDim vetN(numcircvigas) 'Determinação do número de vigas radiais e transversais For ii = 1 To numcircvigas shtTetoSup.Cells(linhatetosup + ii, 2) = "Vigas Radiais " & ii N = pi * 2 * vetR(ii) / b 'Número mínimo de lados do polígono formado pelas vigas transversais cont = 8 137 quociente = N / cont Do While quociente >= 10 cont = cont + 1 quociente = N / cont Loop N = WorksheetFunction.RoundUp(quociente, 0) * cont shtTetoSup.Cells(linhatetosup + ii, 3) = N vetVT(ii) = cont vetN(ii) = N If ii <> 1 Then If (vetN(ii) Mod vetVT(ii - 1) <> 0) Then cont = vetVT(ii - 1) + 1 Do While (vetN(ii) Mod cont <> 0) Or (vetN(ii - 1) Mod cont <> 0) cont = cont + 1 If cont = vetN(ii) Then vetN(ii) = vetN(ii) + 1 cont = vetVT(ii - 1) Do While vetN(ii) Mod cont <> 0 vetN(ii) = vetN(ii) + 1 Loop shtTetoSup.Cells(linhatetosup + ii, 3) = vetN(ii) End If Loop vetVT(ii - 1) = cont End If End If b = 1.7 Next ii 'Armazena o peso de cada viga radial (kgf) ReDim vetP(numcircvigas) 'Dimensionar vigas radiais perfil = shtDados.Range("B21") 138 For ii = 1 To numcircvigas L = WorksheetFunction.RoundUp(vetR(ii) - vetR(ii + 1), 1) qv = (Q * pi * (vetR(ii) ^ 2 - vetR(ii + 1) ^ 2)) / (vetN(ii) * L) ppestr = 0 For kk = 1 To 2 qv = qv + ppestr M = qv * L ^ 2 / 8 Wreq = 100 * M / S If kk = 1 Or Wreq > Wadot Then uL = Sheets(perfil).Cells(Rows.Count, 1).End(xlUp).Row For jj = 3 To uL If Sheets(perfil).Cells(jj, "E") > Wreq And Sheets(perfil).Cells(jj, "J") > (6.35 + shtDados.Cells(18, 2)) Then shtTetoSup.Cells(linhatetosup + ii, "F") = Sheets(perfil).Cells(jj, 1) shtTetoSup.Cells(linhatetosup + ii, "G") = Sheets(perfil).Cells(jj, "E") & " cm³" Wadot = Sheets(perfil).Cells(jj, "E") ppestr = Sheets(perfil).Cells(jj, "B") area = Sheets(perfil).Cells(jj, "C") I = Sheets(perfil).Cells(jj, "D") Exit For End If Next jj End If Next kk 'Verificação quanto ao cisalhamento