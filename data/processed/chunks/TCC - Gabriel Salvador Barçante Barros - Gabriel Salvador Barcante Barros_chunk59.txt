If costado = 0 Then uL = shtOutputCostadoA.Cells(Rows.Count, 8).End(xlUp).Row If uL = 16 Then MsgBox "Os valores das espessuras comerciais devem ser especificados na coluna correspondente." Exit Sub End If shtOutputCostadoA.Range("H17:H" & uL).Copy shtContraventamento.Range("D" & linhacontr + 1).PasteSpecial Application.CutCopyMode = False ElseIf costado = 1 Then uL = shtOutputCostado.Cells(Rows.Count, 8).End(xlUp).Row If uL = 17 Then MsgBox "Os valores das espessuras comerciais devem ser especificados na coluna correspondente." Exit Sub End If shtOutputCostado.Range("I16:I" & uL).Copy shtContraventamento.Range("D" & linhacontr + 1).PasteSpecial Application.CutCopyMode = False End If shtContraventamento.Visible = True shtContraventamento.Activate Cells(1, 1).Select uL = Cells(Rows.Count, 2).End(xlUp).Row tf = Cells(uL, 4) - Cells(uL, 5) For ii = numaneis To 1 Step -1 tr = Cells(uL - ii + 1, 4) - Cells(uL - ii + 1, 5) W = Cells(uL - ii + 1, 3) 151 razao = (tf / tr) ^ 5 Wtr = W * Sqr(razao) Cells(uL - ii + 1, 6) = Wtr Cells(uL - ii + 1, 6).NumberFormat = "0.000" Next ii Wtr = WorksheetFunction.Sum(Range("F17:F" & uL)) Cells(uL + 1, 6) = Wtr Cells(uL + 1, 6).NumberFormat = "0.000" 'Cáculo da altura máxima não reforçada do costado razao = (tf / D) ^ 1.5 H1 = 9.47 * tf * razao * ((190 / V) ^ 2) Range("E15") = H1 Range("E15").NumberFormat = "0.00" Set Tabela = Range("F17:F" & uL + 1) Call FormatarTabela(Tabela) If H1 > Wtr Then Range("E12") = "Não Necessário" numcontr = 0 ElseIf H1 < Wtr Then numcontr = WorksheetFunction.RoundDown((Wtr / H1), 0) Range("E12") = "Necessário" 'Criar tabela nova Cells(uL + 3, 2) = "Perfil" Cells(uL + 3, 3) = "Segemento do Costado" Cells(uL + 3, 4) = "Dimensões do Perfil (mm)" Cells(uL + 3, 5) = "Distância ao topo do segmento considerado (m)" Cells(uL + 3, 6) = "Módulo de Resistência Mínimo (cm³)" Range("B" & uL + 3 & ":F" & uL + 3).Font.Color = RGB(255, 255, 255) Range("B" & uL + 3 & ":F" & uL + 3).Font.Bold = True 152 Range("B" & uL + 3 & ":F" & uL + 3).Interior.Color = RGB(64, 64, 64) Range("C" & uL + 3 & ":F" & uL + 3).WrapText = True 'Selecionar o perfil adequado para o Anel de Contraventamento (BSI BS EN 14015, 2005) Select Case D Case Is <= 20 perfil = "100 x 65 x 8" Case Is <= 36 perfil = "120 x 80 x 10" Case Is <= 48 perfil = "150 x 90 x 10" Case Else perfil = "200 x 100 x 12" End Select For jj = 1 To numcontr xfic = jj * (Wtr / (numcontr + 1)) For ii = 18 To 17 + numaneis aux = aux + Cells(ii, "F") If aux > xfic Then 'Distância real a partir do topo do anel xreal = (Cells(ii, "C") * (aux - xfic)) / Cells(ii, "F") Exit For End If Next ii uL = Cells(Rows.Count, 2).End(xlUp).Row + 1 Cells(uL, 2) = "P" & jj Cells(uL, 3) = Cells(ii, 2) Cells(uL, 4) = perfil Cells(uL, 5) = xreal