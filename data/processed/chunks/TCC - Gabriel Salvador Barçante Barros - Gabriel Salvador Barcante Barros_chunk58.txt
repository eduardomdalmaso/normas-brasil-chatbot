50 + t1com Wb = WorksheetFunction.Max(Wb, 750) Else MsgBox "Modelo presente nas Tabelas 5.1a e 5.1b, da norma API 650, não pode ser empregado para o cálculo da " _ & "espessura das chapas anulares, logo este valor será determinado pelo máximo entre os valores mínimos entre" _ & "as normas API 650 (2016) e N-270 (2014)." tb = CA End If 'Verificação da epessura mínima pela N-270 tb = tb - CA For ii = 3 To 6 If t1com <= shtBanco.Cells(ii, "M") And shtDados.Range("B8") = "Fundo Cônico com declividade para a periferia" Then If tb < shtBanco.Cells(ii, "N") Then tb = shtBanco.Cells(ii, "N") Exit For End If ElseIf t1com <= shtBanco.Cells(ii, "M") And shtDados.Range("B8") = "Fundo Cônico com declividade para o centro" Then If tb < shtBanco.Cells(ii, "O") Then tb = shtBanco.Cells(ii, "O") Exit For End If ElseIf shtDados.Range("B8") = "Fundo Plano" Then End If Next ii 148 uL = shtFundo.Cells(Rows.Count, 2).End(xlUp).Row + 1 shtFundo.Cells(uL, 2) = "Chapas Anulares" shtFundo.Cells(uL, 3) = mat1anel shtFundo.Cells(uL, 4) = tb + CA Wb = Wb * 10 ^ (-3) shtFundo.Cells(uL, 5) = Wb ElseIf shtDados.Range("B10") = "Chapas Recortadas" Then If grupomat = "IV" Or grupomat = "IVA" Or grupomat = "V" Or grupomat = "VI" Then If tensao0 > 160 Or tensao > 171 Then MsgBox "Segundo a API 650 (2016), não foi possível a utilização de materiais dos grupos IV, IVA, V ou VI " _ & "para o 1º anel do costado ao mesmo tempo que chapas recortadas para o contorno do fundo, devido as " _ & "tensões de projeto e de teste hidrostátivo serem maiores que as tensões permissíveis pela dada norma." Exit Sub End If End If uL = shtFundo.Cells(Rows.Count, 2).End(xlUp).Row + 1 shtFundo.Cells(uL, 2) = "Chapas Recortadas" shtFundo.Cells(uL, 3) = shtDados.Range("B12") shtFundo.Cells(uL, 4) = 6.3 + CA shtFundo.Cells(uL, 5) = 1.8 End If uL = shtFundo.Cells(Rows.Count, 2).End(xlUp).Row + 1 shtFundo.Cells(uL, 2) = "Demais Chapas do Fundo" shtFundo.Cells(uL, 3) = shtDados.Range("B12") shtFundo.Cells(uL, 4) = 6.3 + CA shtFundo.Cells(uL, 5) = 1.8 Set Tabela = shtFundo.Range("B14:E15") Call FormatarTabela(Tabela) End Sub 149 7.1.4 Código para o projeto do anel de contraventamento intermediário Option Explicit Sub Projeto_AnelContraventamento() Dim numaneis As Integer, uL As Integer, ii As Integer, jj As Integer, numcontr As Integer, linhacontr As Integer Dim tf As Single, tr As Single, razao As Single, Wtr As Single, W As Single, H1 As Single, Z As Single Dim xreal As Single, xfic As Single, aux As Single Dim D As Single, Hmax As Single, V As Single Dim Tabela As Range, costado As Byte, perfil As String shtContraventamento.Visible = True shtContraventamento.Activate D = shtDados.Cells(5, 2) Hmax = shtDados.Cells(6, 2) numaneis = shtDados.Cells(7, 2) V = shtDados.Cells(13, 2) costado = shtDados.Range("E1") linhacontr = 17 uL = shtContraventamento.Cells(Rows.Count, 2).End(xlUp).Row + 1 shtContraventamento.Range("B" & linhacontr + 1 & ":F" & uL).Clear shtContraventamento.Range("E12:E15").ClearContents uL = shtInputCostado.Cells(Rows.Count, 2).End(xlUp).Row shtInputCostado.Range("B12:E" & uL).Copy shtContraventamento.Range("B" & linhacontr + 1).PasteSpecial Application.CutCopyMode = False uL = shtContraventamento.Cells(Rows.Count, 2).End(xlUp).Row 150 shtContraventamento.Range("D" & linhacontr + 1 & ":D" & uL).Clear