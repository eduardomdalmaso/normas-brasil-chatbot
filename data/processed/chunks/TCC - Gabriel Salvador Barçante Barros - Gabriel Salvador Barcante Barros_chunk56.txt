1)) / declteto - (vetR(1) - vetR(ii + 1)) / declfundo shtTetoSup.Cells(uL + ii, 4) = L L = L * 10 ^ 3 'Raio de giração mínimo r = L / 180 jj = 3 uL2 = Sheets(perfil).Cells(Rows.Count, 1).End(xlUp).Row 'Loop até que encontre o perfil que não flambe deubom = False Do While deubom = False For jj = jj To uL2 If Sheets(perfil).Cells(jj, "C") > r Then lambda = L / Sheets(perfil).Cells(jj, "C") shtTetoSup.Cells(uL + ii, "F") = Sheets(perfil).Cells(jj, 1) If perfil = "Perfil Tubular" Then ttub = Sheets(perfil).Cells(jj, "F") Rtub = Sheets(perfil).Cells(jj, "E") / 2 area = Sheets(perfil).Cells(jj, "D") End If Exit For End If Next jj 142 'Cálculo do fator de segurança FS = 5 / 3 + lambda / 350 + (lambda ^ 3) / 18300000 Select Case perfil Case Is = "Perfil Tubular" If ttub / Rtub >= 0.015 Then y = 1 Else y = (200 / 3) * (ttub / Rtub) * (2 - (200 / 3) * (ttub / Rtub)) End If Case Is = "Perfil Duplo U" y = 1 End Select 'Calculo da tensão máxima admissível (psi) Select Case lambda Case Is <= 120 aux = (1 - (lambda ^ 2) / 34700) * (33000 * y / FS) Case Is > 131.7 aux = 149000000 * y / ((lambda ^ 2) * (1.6 - lambda / 200)) Case Else aux = (1 - (lambda ^ 2) / 34700) * (33000 * y / FS) / (1.6 - lambda / 200) End Select If ii <> numcircvigas Then tensao = (vetPVT(ii) / area) * 2.20462 'Transformar de kgf/in² para psi Else tensao = (vetN(numcircvigas) * vetP(numcircvigas) / 2) / area * 2.20462 End If 'Verificação quanto a flambagem If tensao < aux Then deubom = True shtTetoSup.Cells(uL + ii, "G") = Sheets(perfil).Cells(jj, "C") & " mm" End If Loop shtTetoSup.Cells(uL + ii, 5) = shtDados.Range("B19") 143 shtTetoSup.Cells(uL + ii, 8) = shtDados.Range("B18") Next ii uL = shtTetoSup.Cells(Rows.Count, 2).End(xlUp).Row For ii = linhatetosup + 1 To uL shtTetoSup.Cells(ii, 4).NumberFormat = "0.00" Next ii Set Tabela = Range("B" & linhatetosup + 1 & ":H" & uL) Call FormatarTabela(Tabela) ElseIf shtDados.Range("B14") = "Teto Fixo Cônico Autoportante" Then shtTetoAuto.Visible = True shtTetoAuto.Activate shtTetoAuto.Range("D14:E14").ClearContents Q = Q * 0.00980665 tn = D / (4.8 * Sin(0.16515)) * Sqr(Q / 2.2) If tn > 13 Then MsgBox "O projeto do tanque de teto fixo cônico autoportante não pode ser executado, já que a espessura corroída das chapas do teto são maiores que 13 mm." shtTetoAuto.Visible = False Exit Sub End If tn = tn + shtDados.Range("B16") tn = WorksheetFunction.Max(tn, 5) shtTetoAuto.Cells(14, "D") = tn shtTetoAuto.Cells(14, "D").NumberFormat = "0.00" shtTetoAuto.Cells(14, "E") = (Q * D ^ 2) / (4.8 * Fyr * Tan(0.16515)) shtTetoAuto.Cells(14, "E").NumberFormat = "0.00" shtDados.Range("E2") = "Sim" End If End Sub 144 7.1.3 Código para o projeto do fundo Option Explicit Sub Projeto_Fundo() Dim t1com As Single, t1req As Single, CA As Single, t1dt As Single, tb As Single, Wb As Single Dim