aux = (qv * L / 2) / area If aux > Sc Then MsgBox "Deu merda" End If 'Verificação quanto à flecha aux = (5 * qv * L ^ 4) / (384 * E * I) If aux > L / 200 Then MsgBox "Deu merda" 139 End If vetP(ii) = L * qv shtTetoSup.Cells(linhatetosup + ii, 4) = L shtTetoSup.Cells(linhatetosup + ii, 5) = shtDados.Range("B19") shtTetoSup.Cells(linhatetosup + ii, 8) = shtDados.Range("B18") Next ii 'Armazena a carga atuante na viga transversal (kgf) ReDim vetPVT(numcircvigas - 1) 'Dimensionar vigas transversais perfil = shtDados.Range("B22") uL = shtTetoSup.Cells(Rows.Count, 2).End(xlUp).Row For ii = 1 To numcircvigas - 1 shtTetoSup.Cells(uL + ii, 2) = "Vigas Transversais " & ii shtTetoSup.Cells(uL + ii, 3) = vetVT(ii) ang = 360 / vetVT(ii) * pi / 180 L = Sqr(2 * (shtInputCostado.Cells(12 + ii, "H") ^ 2) - 2 * (shtInputCostado.Cells(12 + ii, "H") ^ 2) * Cos(ang)) qv = (vetP(ii + 1) * vetN(ii + 1) / vetVT(ii) / 2 + vetP(ii) * vetN(ii) / vetVT(ii) / 2) / L ppestr = 0 For kk = 1 To 2 qv = qv + ppestr M = qv * L ^ 2 / 8 Wreq = 100 * M / S If kk = 1 Or Wreq > Wadot Then uL2 = Sheets(perfil).Cells(Rows.Count, 1).End(xlUp).Row For jj = 3 To uL2 If Sheets(perfil).Cells(jj, "E") > Wreq And Sheets(perfil).Cells(jj, "J") > (6.35 + shtDados.Cells(18, 2)) Then shtTetoSup.Cells(uL + ii, "F") = Sheets(perfil).Cells(jj, 1) shtTetoSup.Cells(uL + ii, "G") = Sheets(perfil).Cells(jj, "E") & " cm³" Wadot = Sheets(perfil).Cells(jj, "E") ppestr = Sheets(perfil).Cells(jj, "B") 140 area = Sheets(perfil).Cells(jj, "C") I = Sheets(perfil).Cells(jj, "D") Exit For End If Next jj End If Next kk vetPVT(ii) = 2 * qv * L 'Verificação quanto ao cisalhamento aux = (qv * L / 2) / area If aux > Sc Then MsgBox "Deu merda" End If 'Verificação quanto à flecha aux = (5 * qv * L ^ 4) / (384 * E * I) If aux > L / 200 Then MsgBox "Deu merda" End If shtTetoSup.Cells(uL + ii, 4) = L shtTetoSup.Cells(uL + ii, 5) = shtDados.Range("B19") shtTetoSup.Cells(uL + ii, 8) = shtDados.Range("B18") Next ii 'Dimensionar colunas perfil = shtDados.Range("B23") uL = shtTetoSup.Cells(Rows.Count, 2).End(xlUp).Row For ii = 1 To numcircvigas If ii <> numcircvigas Then shtTetoSup.Cells(uL + ii, 2) = "Colunas Intermediárias " & ii shtTetoSup.Cells(uL + ii, 3) = vetVT(ii) Else shtTetoSup.Cells(uL + ii, 2) = "Colunas Central" shtTetoSup.Cells(uL + ii, 3) = 1 141 End If declteto = Right(shtDados.Cells(15, 2), InStr(1, shtDados.Cells(15, 2), ":", 1)) If shtDados.Range("B8") = "Fundo Cônico com declividade para o centro" Then declfundo = Right(shtDados.Cells(9, 2), InStr(1, shtDados.Cells(9, 2), ":", 1)) declfundo = (-1) * declfundo ElseIf shtDados.Range("B8") = "Fundo Cônico com declividade para a periferia" Then declfundo = Right(shtDados.Cells(9, 2), InStr(1, shtDados.Cells(9, 2), ":", 1)) ElseIf shtDados.Range("B8") = "Fundo Plano" Then L = Hmax + (vetR(ii) - vetR(ii + 1)) / declteto End If 'Comprimento das colunas L = Hmax + (vetR(1) - vetR(ii +