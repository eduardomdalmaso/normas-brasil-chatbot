ENGENHARIA. NORTEC, abril 2014. N-271b. PETROBRAS. ENGENHARIA. CONTEC. Medição de Recalque de Fundações no Teste Hidrostático de Equipamentos. Rio de Janeiro: PETROBRAS. ENGENHARIA. NORTEC, julho 2015. N-1807e. PETROBRAS. ENGENHARIA. CONTEC. Tratamento de Superfície de Base de Tanque. Rio de Janeiro: PETROBRAS. ENGENHARIA. NORTEC, abril 2013. N-1822c. PETRÓLEO BRASILEIRO S. A. Ficha de Informações de Segurança de Produto Químico – Gasolina A. Rio de Janeiro: Petrobras, 22 maio 2013. NOVAES, Antonio Galvão. Logística e gerenciamento da cadeia de distribuição. 3 ed. Rio de Janeiro: Elsevier, 2007. 127 7 APÊNDICES 7.1 APÊNDICE 1 7.1.1 Código para o projeto do costado Option Explicit Sub Projeto_Costado() Dim ii As Integer, jj As Integer, numaneis As Integer, uL As Integer, cont As Integer, linhaA As Integer, linhain As Integer Dim Hmax As Single, h As Single, D As Single, G As Single, E As Single, CA As Single, tmin As Single, tn As Single Dim Tabela As Range Application.ScreenUpdating = False G = shtDados.Cells(4, 2) D = shtDados.Cells(5, 2) Hmax = shtDados.Cells(6, 2) numaneis = shtDados.Cells(7, 2) E = 0.85 G = WorksheetFunction.Max(G, 1) Select Case D Case Is < 15 tmin = 4.75 Case Is < 36 tmin = 6.3 Case Is < 60 tmin = 8 Case Is > 60 tmin = 9.5 128 End Select linhaA = 16 linhain = 11 cont = 0 h = Hmax uL = shtOutputCostadoA.Cells(Rows.Count, 2).End(xlUp).Row + 2 shtOutputCostadoA.Range("B" & linhaA + 1 & ":H" & uL).Clear For ii = 1 To numaneis uL = shtOutputCostadoA.Cells(Rows.Count, 6).End(xlUp).Row + 1 CA = shtInputCostado.Cells(linhain + ii, 5) tn = (4.9 * D * (h - 0.3) * G) / (145 * E) + CA shtOutputCostadoA.Cells(uL, 6) = tn shtOutputCostadoA.Cells(uL, 6).NumberFormat = "0.00" If tn > tmin Then shtOutputCostadoA.Cells(uL, 7) = tn Else shtOutputCostadoA.Cells(uL, 7) = tmin End If shtOutputCostadoA.Cells(uL, 7).NumberFormat = "0.00" h = Hmax - ii * shtInputCostado.Cells(linhain + ii, 3) If shtOutputCostadoA.Cells(uL, 6) > 13 Then shtOutputCostadoA.Range("F" & linhaA + 1 & ":G" & uL).ClearContents Call MetodoPontoVariavel(tmin) Exit For End If cont = cont + 1 Next ii If cont = numaneis Then 129 shtOutputCostadoA.Visible = True shtOutputCostadoA.Activate shtOutputCostadoA.Cells(8, 5) = G shtOutputCostadoA.Cells(11, 5) = (3.14159265358979 * Hmax * D ^ 2) / 4 shtOutputCostadoA.Cells(12, 5) = E uL = shtInputCostado.Cells(Rows.Count, 2).End(xlUp).Row shtInputCostado.Range("B" & linhain + 1 & ":E" & uL).Copy shtOutputCostadoA.Range("B" & linhaA + 1).PasteSpecial xlValues Application.CutCopyMode = False 'Determinação da espessura comercial uL = shtOutputCostadoA.Cells(Rows.Count, 2).End(xlUp).Row For ii = linhaA + 1 To uL For jj = 3 To 46 If shtOutputCostadoA.Cells(ii, 7) > shtBanco.Cells(jj, "R") And shtOutputCostadoA.Cells(ii, 7) <= shtBanco.Cells(jj + 1, "R") Then shtOutputCostadoA.Cells(ii, 8) = shtBanco.Cells(jj + 1, "R") End If Next jj Next ii uL = shtOutputCostadoA.Cells(Rows.Count, 2).End(xlUp).Row Set Tabela = shtOutputCostadoA.Range("B" & linhaA + 1 & ":H" & uL) Call FormatarTabela(Tabela) shtOutputCostadoA.Cells(1, 1).Select shtDados.Range("E1") = 0 End If 130 End Sub Sub MetodoPontoVariavel(tmin As Single) Dim ii As Integer, jj As Integer, kk As Integer, cont As Integer, uL As Integer, linhapv As Integer, linhain As Integer Dim Hmax As